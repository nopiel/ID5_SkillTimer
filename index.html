<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="utf-8">
<title>jQuery Number CountUP</title>
<link rel="stylesheet" type="text/css" href="css/reset.css">
<link rel="stylesheet" type="text/css" href="css/common.css">
<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.0/jquery.min.js"></script>
<script>
$(function(){
/*
	var countElm = $('.skillCount1'),
	countSpeed = 1000;

    $('.countdownArea').on('click',function(){
       if($(this).hasClass('active')) {
            countdown(1);
           $(this).text($(this).attr('data-num'));
           $(this).removeClass('active');
       }else{
           countdown(0);
           $(this).addClass('active');


       }

    });

    function countdown(flg){

            var self = countElm,
            countMax = self.attr('data-num'),
            thisCount = self.text(),
            countTimer;

        if(flg==1){
            clearInterval(countTimer);
             console.log("a")
        }
        else{
            timer();
        }


        function timer(){

                countTimer = setInterval(function(){
                    var countNext = thisCount=thisCount-1;
                    self.text(countNext);

                    if(countNext == 0){

                        clearInterval(countTimer);
                    }
                },countSpeed);
            }
        }
*/


var init = [],
countTimer = [],
activeCounter = [];

$(".skillarea").each(function(i){
	init[i] = $(".countdownArea",this).data("num");
});
$(".skillarea").click(function(){
  a($(".skillarea").index($(this)));
});




$(window).keydown(function(e){
  var i = 0;
  switch(e.keyCode){
    case 97:
      i = 0;
    break;
    case 98:
      i = 1;
    break;
    case 99:
      i = 2;
    break;
    case 100:
      i = 3;
    break;
  }
   a(i);
});

function a(i){
  var _self = $(".countdownArea").eq(i);
  	if($(".skillarea").eq(i).hasClass("active")){
  		counterClear(i);
  	}else{
  		countTimer[i] = setInterval(function(){

              var next = _self.text() - 1;
  			_self.text(next);
              if(next <= 0) counterClear(i);

  		},1000);
      $(".skillarea").eq(i).addClass("active");
  	}
//  	$(".skillarea").eq(i).toggleClass("active");
}




function counterClear(i){
	clearInterval(countTimer[i]);
	$(".countdownArea").eq(i).text(init[i]);
    $(".skillarea").eq(i).removeClass('active');
}


});
</script>
</head>

<body>


<div id="container">

<div class="skillarea">
    引き留める
    <div class="skillCount1 countdownArea" data-num="120">120</div>
</div>

<div class="skillarea">
    瞬間移動
    <div class="skillCount2 countdownArea" data-num="100">100</div>
</div>

<div class="skillarea">
    神出鬼没
    <div class="skillCount3 countdownArea" data-num="150">150</div>
</div>
</div><!-- /#container -->


</body>
</html>
